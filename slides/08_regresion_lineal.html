<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Métodos Estadísticos con R</title>
    <meta charset="utf-8" />
    <meta name="author" content="Gibrán Peniche" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
    <link rel="stylesheet" href="style.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">





class: title-slide, middle

.pull-left[ 
# Métodos Estadísticos Bayesianos con R
## Regresión Líneal
### Gibrán Peniche
### v. 0.0.1
### 2020-10-03
####  &lt;i class="fab fa-github"&gt;&lt;/i&gt; [jgpeniche](https://github.com/jgpeniche)
####  &lt;i class="fab fa-twitter"&gt;&lt;/i&gt; [PenicheGibran](https://twitter.com/PenicheGibran)
####  &lt;i class="fab fa-google"&gt;&lt;/i&gt; jgpeniche@gmail.com

]

.pull-right[

![](figs/logo_g.png)

]

---
# La sesión pasada...

--

- Caracterizamos la estimación por regiones a través de `\(\pi(\theta)\)`

--

- Definimos la distribucción *posterior predictiva* para resolver el problema de **pronóstico**

--

- Dedujimos como realizar estimación por regiones y dimos una introducción al contraste de hipótesis a través de `\(\pi(\theta)\)` y `\(p(x^* | X_{(\underline{n})})\)`

---

# Agenda

--

En la sesión de hoy vamos a estudiar la historia y el problema de regresión lineal como una introducción a la inferencia bayesiana computacional

--

Estudiaremos: 


--

  1. Contexto histórico de la regresión lineal

--

  2. Definición análitica del problema

--

  3. Solución frecuentista
  
--

  4. Solución Bayesiana: Inferencia conjugada
  
--

  5. Solución Bayesiana: Inferencia computacional

---

# Bibliografía 

El contenido de esta sesión lo pueden encontrar en las siguientes referencias

  - *Bayesian Data Analysis*., Gelman, Andrew, *et al*., Cap 14.
  - *Monte Carlo Markov Chain; Stochastic Simulation for Bayesian Inference*., Gammerman, Dani., Cap 2
  - [The Discovery of Statistical Regression](https://priceonomics.com/the-discovery-of-statistical-regression/)
  - [Stan User's Guide](https://mc-stan.org/docs/2_24/stan-users-guide/index.html)
  - [RStan Getting Started](https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started)
  - [Hoy to use the RStanarm package](https://cran.r-project.org/web/packages/rstanarm/vignettes/rstanarm.html)
  -[Bayesian Linear Regression — Different ConjugateModels and Their (In)Sensitivity to Prior-Data Conflict](https://core.ac.uk/download/pdf/12171733.pdf)
  - [Tidy Modelling with R](https://www.tmwr.org/models.html)., Kuhn, Max., Silge, Julia.,  Cap 7.)
  - [Extracting and visualizing tidy draws from rstanarm models](http://mjskay.github.io/tidybayes/articles/tidy-rstanarm.html)
  - [The case for Tidymodels](https://rviews.rstudio.com/2020/04/21/the-case-for-tidymodels/)
  - [Updating: A Set of Bayesian Notes](https://jrnold.github.io/bayesian_notes/), Cap 11.


---

class: center, inverse, middle
# 1

--

# Contexto Histórico de la regresión lineal

---

# Contexto histórico de la regresión lineal

--

Un problema tan *trivial* que Carl Friederich Gauss pensó que el no podía haber sido el primero en utilzarlo, hasta que Adrein-Mari Legendre publicó un artículo sobre el tema varios años después (New Methods for Determination of the Orbits of Comets, 1805), desatando una de las discusiones de adjucación más famosas en la historia de las matemáticas

--

Si bien el intercambio de correo fue acalorado, al final se le atribuyo el " *descubrimiento* " del método de **mínimos cuadrados** a Gauss que por cierto sentía pena por los colegas que no la habían descubierto antes y no lo consideraba como el más relevante de sus descubrimientos

--

El término " *regresión* " no se comenzó a utilizarce hasta 1886 en el estudio publicado por Sir. Francis Galton *Regression Towards Mediocrity in Hereditary Stature*, en el que describia como la altura de los árboles tendía a **revertirse hacia la media** ( `\(0 &lt;| \beta_1 | &lt; 1\)` )

---

# Contexto histórico de la regresión lineal

Más tarde, alrededor de 1901, Karl pearson (uno de los fundaderos de la escuela frecuentista) comenzó a utilizar el término "la línea de regresión" derivado de su estudio de la representación gráfica del problema resuelto por Galton

--

También fue Karl Pearson quien acuñó el término de *Coeficiente de Determinación* (mejor como correlación) 

--

Sin embargo la *Teoría de Regresión* la desarrollo en su mayoría Ronald A. Fisher, (particularmente introduciendo en argumento máximo verosímil y el análisis de varianza ANOVA) convirtiendola en una de las joyas de la corona de la escuela de la Estadística Matemática

---
class: center, inverse, middle
# 2

--

# Definición del problema (regresión lineal simple)

---

# Definición del problema

Considere un conjunto de observaciones `\(\{ (y_i, x_i)\}_{i = 1}^n\)` tal que `\(y_i = \beta_0 + \beta_1 x_i + \varepsilon_i\)`, donde `\(\varepsilon_i \sim N(0,\sigma^2)\)`

--

Luego entonces $$ Y | X, \beta, \sigma^2 \sim N( X\beta, \sigma ^2 I)$$

--

Además:

--

  1. `\(\sigma^2I \quad \Rightarrow \quad \rho(\varepsilon_i, \varepsilon_j) = 0\)` y homocedastcidad

--

  2. La relación es **lineal**
  
---

class: inverse, center, middle

# Los datos de Sir Francis Galton

---

# Los datos de Sir Francis Galton

&lt;table&gt;
&lt;caption&gt;Árboles de Galton&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Family &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Father &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Mother &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Gender &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Height &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Kids &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 78.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 67.0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 73.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 78.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 67.0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; F &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 69.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 78.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 67.0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; F &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 69.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 78.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 67.0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; F &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 69.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 75.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 66.5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 73.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 75.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 66.5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 72.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 75.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 66.5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; F &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 65.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 75.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 66.5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; F &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 65.5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 75.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 64.0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 71.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 75.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 64.0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; F &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 68.0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


---

class: center, inverse, middle
# 3

--

# Solución Frecuentista

---

# Solución frecuentista

**TEO** **Gauss - Markov**

--

*Mínimos cuadrados ordinarios produce los mejores estimadores insesgados de varianza mínima* (OLS is BLUE)


--

Algunas críticas...

--

  1. El procedimiento derivado de este teorema ya incorpora el argumento máximo verosimil de Fisher
  
--

  2. Recordemos que el problema es **probabilístico** por naturaleza y MCO es un argumento **geométrico**, en particular se puede plantear desde lel estudio del cálculo minizando la distancia euclideana entre los puntos y la recta
  
--

  3. En mi opinion "está raro" porque el argumento geométrico no incorpora la naturaleza aleatoria del fenómeno
  
---

# MCO en R

--

Como seguramente lo harían ustedes...


```r
modelo1 &lt;- lm(Height ~ Father, data = galton)

summary(modelo1)
```

```
## 
## Call:
## lm(formula = Height ~ Father, data = galton)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.2683  -2.6689  -0.2092   2.6342  11.9329 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 39.11039    3.22706  12.120   &lt;2e-16 ***
## Father       0.39938    0.04658   8.574   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 3.446 on 896 degrees of freedom
## Multiple R-squared:  0.07582,	Adjusted R-squared:  0.07479 
## F-statistic: 73.51 on 1 and 896 DF,  p-value: &lt; 2.2e-16
```
---

# MCO en R

--

1. Sin análisis exploratorio

--

2. Sintáxis obsoleta

--

3. Sin control de preprocsamiento

--

4. Sin grupo de entrenamiento y prueba

--

5. Pésimo formato de presentación

---

# MCO en R con `tidymodels`. Frecuentista

### Análisis Exploratorio de Datos

&lt;img src="08_regresion_lineal_files/figure-html/exp1,-1.png" height="400" style="display: block; margin: auto;" /&gt;
---


# MCO en R con `tidymodels`, Frecuentista

### Análisis Exploratorio de Datos

&lt;img src="08_regresion_lineal_files/figure-html/exp2,-1.png" height="400" style="display: block; margin: auto;" /&gt;

---

# MCO en R con `tidymodels`, Frecuentista



```r
library(tidymodels)

# Conjunto de entrenamiento
galton_split &lt;- galton %&gt;% 
  initial_split(prop = .8)

# Preporcesamiento de datos
galton_recipe &lt;- training(galton_split) %&gt;%
  recipe(Height ~ Father) %&gt;%
  #step_corr(all_predictors()) %&gt;%
  #step_center(all_predictors(), -all_outcomes()) %&gt;%
  #step_scale(all_predictors(), -all_outcomes()) %&gt;%
  prep()

# Pre-procesamiento
galton_testing &lt;- galton_recipe %&gt;%
  bake(testing(galton_split))

# lm
galton_freq &lt;- linear_reg() %&gt;%
  set_engine("lm") %&gt;%
  fit(Height ~ Father, data = galton_recipe %&gt;%  juice() )
```

---

# MCO en R con `tidymodels`, Frecuentista

<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ilyzlwzdue .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ilyzlwzdue .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ilyzlwzdue .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ilyzlwzdue .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ilyzlwzdue .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ilyzlwzdue .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ilyzlwzdue .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ilyzlwzdue .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ilyzlwzdue .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ilyzlwzdue .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ilyzlwzdue .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ilyzlwzdue .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ilyzlwzdue .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ilyzlwzdue .gt_from_md > :first-child {
  margin-top: 0;
}

#ilyzlwzdue .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ilyzlwzdue .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ilyzlwzdue .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#ilyzlwzdue .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ilyzlwzdue .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#ilyzlwzdue .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ilyzlwzdue .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ilyzlwzdue .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ilyzlwzdue .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ilyzlwzdue .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ilyzlwzdue .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#ilyzlwzdue .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ilyzlwzdue .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#ilyzlwzdue .gt_left {
  text-align: left;
}

#ilyzlwzdue .gt_center {
  text-align: center;
}

#ilyzlwzdue .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ilyzlwzdue .gt_font_normal {
  font-weight: normal;
}

#ilyzlwzdue .gt_font_bold {
  font-weight: bold;
}

#ilyzlwzdue .gt_font_italic {
  font-style: italic;
}

#ilyzlwzdue .gt_super {
  font-size: 65%;
}

#ilyzlwzdue .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="ilyzlwzdue" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="7" class="gt_heading gt_title gt_font_normal" style>Training Fit</th>
    </tr>
    <tr>
      <th colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Coeficiente</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Ajuste</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Estadística T</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Valor p</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">conf.low</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">conf.high</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">(Intercept)</td>
      <td class="gt_row gt_right">38.51</td>
      <td class="gt_row gt_right">3.55</td>
      <td class="gt_row gt_right">10.85</td>
      <td class="gt_row gt_right">0.00</td>
      <td class="gt_row gt_right">31.54</td>
      <td class="gt_row gt_right">45.48</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">Father</td>
      <td class="gt_row gt_right">0.41</td>
      <td class="gt_row gt_right">0.05</td>
      <td class="gt_row gt_right">7.96</td>
      <td class="gt_row gt_right">0.00</td>
      <td class="gt_row gt_right">0.31</td>
      <td class="gt_row gt_right">0.51</td>
    </tr>
  </tbody>
  
  
</table></div>
---

# MCO en R con `tidymodels`, Frecuentista

<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#qsseghvdbj .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qsseghvdbj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qsseghvdbj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qsseghvdbj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qsseghvdbj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qsseghvdbj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qsseghvdbj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qsseghvdbj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qsseghvdbj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qsseghvdbj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qsseghvdbj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qsseghvdbj .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#qsseghvdbj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qsseghvdbj .gt_from_md > :first-child {
  margin-top: 0;
}

#qsseghvdbj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qsseghvdbj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qsseghvdbj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#qsseghvdbj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qsseghvdbj .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#qsseghvdbj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qsseghvdbj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qsseghvdbj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qsseghvdbj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qsseghvdbj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qsseghvdbj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#qsseghvdbj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qsseghvdbj .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#qsseghvdbj .gt_left {
  text-align: left;
}

#qsseghvdbj .gt_center {
  text-align: center;
}

#qsseghvdbj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qsseghvdbj .gt_font_normal {
  font-weight: normal;
}

#qsseghvdbj .gt_font_bold {
  font-weight: bold;
}

#qsseghvdbj .gt_font_italic {
  font-style: italic;
}

#qsseghvdbj .gt_super {
  font-size: 65%;
}

#qsseghvdbj .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="qsseghvdbj" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Metrica</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">valor</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Valor</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">r.squared</td>
      <td class="gt_row gt_right">0.08</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">adj.r.squared</td>
      <td class="gt_row gt_right">0.08</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">sigma</td>
      <td class="gt_row gt_right">3.47</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">statistic</td>
      <td class="gt_row gt_right">63.30</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">p.value</td>
      <td class="gt_row gt_right">0.00</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">df</td>
      <td class="gt_row gt_right">1.00</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">logLik</td>
      <td class="gt_row gt_right">&minus;1,913.71</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">AIC</td>
      <td class="gt_row gt_right">3,833.43</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">BIC</td>
      <td class="gt_row gt_right">3,847.16</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">mape</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">4.150546</td>
    </tr>
  </tbody>
  
  
</table></div>


---

class: center, inverse, middle

# 4

--

# Solución Bayesiana: Inferencia conjugada

---

# Solución Bayesiana: Inferencia conjugada

Interesa hacer inferencia sobre `\(\theta = (\beta_0, \beta_1, \sigma^2) \quad \epsilon \quad\mathbb{R} \times \mathbb{R} \times \mathbb{R}^+\)`

--

La solución conjugada al problema de regresión lineal, está definida por el sistema *Normal - Inversa Gamma* donde `\(\beta | \sigma^2 \sim Normal\)` y `\(\sigma^2 \sim \Gamma^{-1}\)`

--

Noten como en este caso el problema de inferencia bayesiano queda definido en 2 niveles o *jerarquías*, *i.e* `\(\pi(\theta) \propto \mathbb{L}(\theta | Y_{(\underline{n})}) p(\beta | \phi)p(\phi)\)`

--

La verosimiltud está dada por:

`$$\mathbb{L}(Y_{(\underline{n})} | \beta, \phi, x) \propto \phi^{-n/2} exp \{-\frac{\phi}{2}[Q(\beta) + S_e]\}$$`

--

donde:

  - `\(Q(\beta) = (\beta - \hat{\beta})´X'X(\beta - \hat{\beta})\)` 
  - `\(\hat{\beta}= (X'X)^{-1}X'y\)`
  - `\(\phi = \frac{1}{\sigma^2}\)`

---

# Solución Bayesiana: Inferencia conjugada

### Distribución *a priori* de referencia

--

Sea `\(p_J(\beta, \phi) \propto \frac{1}{\sigma^2}\)`

--

`\(\Longrightarrow\)`

--

  1. `\(\pi(\theta) = \pi(\beta_0, \beta_1,\phi) \sim NIG\)`, de la cual marginalizado

--
 
  - `\(\beta_1 | Y_{(\underline{n})} \sim t(n - 2, \hat{\beta_1}, \frac{\hat{\sigma^2}}{S_{xx}})\)`

--

  - `\(\beta_0 | Y_{(\underline{n})} \sim t(n-2, \hat{\beta_0}, \hat{\sigma}^2(\frac{1}{n}+\frac{\overline{x}^2}{S_{xx}}))\)`
    
--

  - `\(\phi | Y_{(\underline{n})} \sim \Gamma (\frac{n-2}{2}, \frac{SSE}{2})\)`

--
  
  - `\(y_{n+1} | Y_{(\underline{n})} \sim t(n-2, \hat{\beta}X_{n+1}, S^2_{Y|X_{n+1}})\)`, donde `\(S^2_{Y|x_i} = \hat{\sigma}^2(1+\frac{1}{n} + \frac{(x_i - \overline{x})^2}{S_{xx}})\)`

---

# Solución Bayesiana: Inferencia conjugada

<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#lwapxeasfr .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lwapxeasfr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lwapxeasfr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lwapxeasfr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lwapxeasfr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lwapxeasfr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lwapxeasfr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lwapxeasfr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lwapxeasfr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lwapxeasfr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lwapxeasfr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lwapxeasfr .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#lwapxeasfr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lwapxeasfr .gt_from_md > :first-child {
  margin-top: 0;
}

#lwapxeasfr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lwapxeasfr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lwapxeasfr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#lwapxeasfr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lwapxeasfr .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#lwapxeasfr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lwapxeasfr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lwapxeasfr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lwapxeasfr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lwapxeasfr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lwapxeasfr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#lwapxeasfr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lwapxeasfr .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#lwapxeasfr .gt_left {
  text-align: left;
}

#lwapxeasfr .gt_center {
  text-align: center;
}

#lwapxeasfr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lwapxeasfr .gt_font_normal {
  font-weight: normal;
}

#lwapxeasfr .gt_font_bold {
  font-weight: bold;
}

#lwapxeasfr .gt_font_italic {
  font-style: italic;
}

#lwapxeasfr .gt_super {
  font-size: 65%;
}

#lwapxeasfr .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="lwapxeasfr" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="6" class="gt_heading gt_title gt_font_normal" style>Distribuciones Posteriores</th>
    </tr>
    <tr>
      <th colspan="6" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Parameter</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Posterior</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Mean</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Sigma</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">alpha</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">beta</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">Intercept</td>
      <td class="gt_row gt_left">t</td>
      <td class="gt_row gt_right">38.51</td>
      <td class="gt_row gt_right">2,260.35</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">Slope</td>
      <td class="gt_row gt_left">t</td>
      <td class="gt_row gt_right">0.41</td>
      <td class="gt_row gt_right">0.47</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">Phi</td>
      <td class="gt_row gt_left">Gamma</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">718.00</td>
      <td class="gt_row gt_right">4,316.08</td>
    </tr>
  </tbody>
  
  
</table></div>

---

# Solución Bayesiana: Inferencia conjugada

<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#pugmomlepk .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pugmomlepk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pugmomlepk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pugmomlepk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pugmomlepk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pugmomlepk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pugmomlepk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pugmomlepk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pugmomlepk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pugmomlepk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pugmomlepk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pugmomlepk .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#pugmomlepk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pugmomlepk .gt_from_md > :first-child {
  margin-top: 0;
}

#pugmomlepk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pugmomlepk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pugmomlepk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#pugmomlepk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pugmomlepk .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#pugmomlepk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pugmomlepk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pugmomlepk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pugmomlepk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pugmomlepk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pugmomlepk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#pugmomlepk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pugmomlepk .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#pugmomlepk .gt_left {
  text-align: left;
}

#pugmomlepk .gt_center {
  text-align: center;
}

#pugmomlepk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pugmomlepk .gt_font_normal {
  font-weight: normal;
}

#pugmomlepk .gt_font_bold {
  font-weight: bold;
}

#pugmomlepk .gt_font_italic {
  font-style: italic;
}

#pugmomlepk .gt_super {
  font-size: 65%;
}

#pugmomlepk .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="pugmomlepk" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="3" class="gt_heading gt_title gt_font_normal" style>Distriubuciones Posteriores predictivas</th>
    </tr>
    <tr>
      <th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">x</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mean</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">variance</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_right">75.50</td>
      <td class="gt_row gt_right">69.30</td>
      <td class="gt_row gt_right">2,179.42</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">75.00</td>
      <td class="gt_row gt_right">69.09</td>
      <td class="gt_row gt_right">2,176.60</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">74.00</td>
      <td class="gt_row gt_right">68.68</td>
      <td class="gt_row gt_right">2,171.65</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">73.00</td>
      <td class="gt_row gt_right">68.28</td>
      <td class="gt_row gt_right">2,167.65</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">73.20</td>
      <td class="gt_row gt_right">68.36</td>
      <td class="gt_row gt_right">2,168.38</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">72.00</td>
      <td class="gt_row gt_right">67.87</td>
      <td class="gt_row gt_right">2,164.60</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">72.50</td>
      <td class="gt_row gt_right">68.07</td>
      <td class="gt_row gt_right">2,166.01</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">71.00</td>
      <td class="gt_row gt_right">67.46</td>
      <td class="gt_row gt_right">2,162.48</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">71.50</td>
      <td class="gt_row gt_right">67.66</td>
      <td class="gt_row gt_right">2,163.42</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">71.70</td>
      <td class="gt_row gt_right">67.75</td>
      <td class="gt_row gt_right">2,163.86</td>
    </tr>
  </tbody>
  
  
</table></div>



---
# Solución Bayesiana: Inferencia Conjugada

### Distribuciones *a priori* informativas

--

Aunque la solución analítica cerrada existe para las distribuciones *a priori*:

--

  1. `\(\beta | \sigma^2 \sim N(b_0, \sigma^2B_0)\)`
  
--

  2. `\(\sigma^2 \sim \Gamma^{-1}(\frac{n_0}{2},\frac{n_0\sigma_0}{2})\)`
  
--

La aproximación bayesiana suele utilizarse partiendo de distribuciones de referencia, sin embargo vale la pena estudiar el caso informativo pues es útil para el **proceso de aprendizaje del modelo**

--

La capacidad de *actualizar* el conocimiento (modelos) a través del teorema de Bayes en el marco de la inferencia *a priori* - *a posteriori* y en particular las formas análiticas cerradas del proceso de actualización es lo que hace tan atractiva la inferencia bayesiana para modelos de ML

---

# Inferencia Bayesiana computacional vía `rstan`

--

La Inferencia Bayesiana computacional descansa prinicpalmente en la Teoría de Cadenas de Markov y hace uso intensivo del cálculo numérico

--

Algunos de los algoritmos más utilizados son el **Gibbs Sampler** y **Metropolis-Hastings** 

--

Existen varios *lenguages* para hacer inferencia bayesiana computacional (**BUGS o JAGS**) pero la libreria más estable para simulación bayesiana es *Stan* desarrollado originalmente por Andrew Gelman y Bob Carpenter con un backcend en *c++* para un **Hamiltonian Monte Caro**

--

Existe una interfaz para hacer inferencia vía Stan en R a través del paquete `rstan`

---

# Inferencia Bayesiana computacional vía `rstan`


```r
stan.model &lt;- "data {
  int&lt;lower=0&gt; N; //observaciones
  vector[N] x;  //predictores
  vector[N] y;  //respuestas
}
parameters {
  real alpha; //ordenada al origen
  real beta; // pendiente
  real&lt;lower=0&gt; sigma;
}
model {
  
  y ~ normal(alpha + beta * x, sigma);
}"
```
---

# Inferencia Bayesiana computacional vía `rstan`


```r
library(rstan)
options(mc.cores = parallel::detectCores())

model_data &lt;- list(
  N = galton_split %&gt;% training() %&gt;% nrow(),
  y = galton_split %&gt;% training() %&gt;% pull(Height),
  x = galton_split %&gt;% training() %&gt;% pull(Father)
)

stan_lm &lt;- stan( file = stan.model,
                data = model_data,
                chains = 4,             # número de Cadenas de Markov 
                warmup = 1000,          # iteraciones de calentamiento
                iter = 2000,            #  total de iteraciones por cadena
                cores = 4)
```

---

# Inferencia Bayesiana computacional vía `rstan`

Después de esto habría que extraer los elementos del objeto, para visualizar las posteriores y hacer el diagnóstico de convergencia

--

Si bien Stan nos da mucha flexibilidad para crear cualquier tipo de modelos, existe una libreria (`rstanarm`) que ya tiene los modelos más comunes de manera estándar (p.e *lm*) en una interfaz compatible con `tidymodels`

---

# Inferencia Bayesiana con `tidymodels`


```r
options(mc.cores = parallel::detectCores())

galton_bayes &lt;- linear_reg() %&gt;%
  set_engine("stan",
             iter = 5000, 
             chains = 4, 
             seed = 666, 
             warmup = 500, 
             cores = 4) %&gt;%
  fit(Height ~ Father, data = galton_recipe %&gt;%  juice() )
```

---

# Inferencia Bayesiana con `tidymodels`

### Ajuste

<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#bfxblmceix .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bfxblmceix .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bfxblmceix .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bfxblmceix .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bfxblmceix .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bfxblmceix .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bfxblmceix .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bfxblmceix .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bfxblmceix .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bfxblmceix .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bfxblmceix .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bfxblmceix .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#bfxblmceix .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bfxblmceix .gt_from_md > :first-child {
  margin-top: 0;
}

#bfxblmceix .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bfxblmceix .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bfxblmceix .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#bfxblmceix .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bfxblmceix .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#bfxblmceix .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bfxblmceix .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bfxblmceix .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bfxblmceix .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bfxblmceix .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bfxblmceix .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#bfxblmceix .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bfxblmceix .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#bfxblmceix .gt_left {
  text-align: left;
}

#bfxblmceix .gt_center {
  text-align: center;
}

#bfxblmceix .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bfxblmceix .gt_font_normal {
  font-weight: normal;
}

#bfxblmceix .gt_font_bold {
  font-weight: bold;
}

#bfxblmceix .gt_font_italic {
  font-style: italic;
}

#bfxblmceix .gt_super {
  font-size: 65%;
}

#bfxblmceix .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="bfxblmceix" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="6" class="gt_heading gt_title gt_font_normal" style>Cuantiles Distribuciones Posteriores</th>
    </tr>
    <tr>
      <th colspan="6" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Parametro</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mean</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">sd</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">10%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">50%</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">90%</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">(Intercept)</td>
      <td class="gt_row gt_right">38.54</td>
      <td class="gt_row gt_right">3.55</td>
      <td class="gt_row gt_right">34.02</td>
      <td class="gt_row gt_right">38.53</td>
      <td class="gt_row gt_right">43.11</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">Father</td>
      <td class="gt_row gt_right">0.41</td>
      <td class="gt_row gt_right">0.05</td>
      <td class="gt_row gt_right">0.34</td>
      <td class="gt_row gt_right">0.41</td>
      <td class="gt_row gt_right">0.47</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">sigma</td>
      <td class="gt_row gt_right">3.47</td>
      <td class="gt_row gt_right">0.09</td>
      <td class="gt_row gt_right">3.36</td>
      <td class="gt_row gt_right">3.47</td>
      <td class="gt_row gt_right">3.59</td>
    </tr>
  </tbody>
  
  
</table></div>
---
# Inferencia Bayesiana con `tidymodels`

### Ajuste

&lt;img src="08_regresion_lineal_files/figure-html/bayes8-1.png" height="400" style="display: block; margin: auto;" /&gt;


---

# Inferencia Bayesiana con `tidymodels`


```
## Priors for model '.' 
## ------
## Intercept (after predictors centered)
##   Specified prior:
##     ~ normal(location = 67, scale = 2.5)
##   Adjusted prior:
##     ~ normal(location = 67, scale = 9)
## 
## Coefficients
##   Specified prior:
##     ~ normal(location = 0, scale = 2.5)
##   Adjusted prior:
##     ~ normal(location = 0, scale = 3.6)
## 
## Auxiliary (sigma)
##   Specified prior:
##     ~ exponential(rate = 1)
##   Adjusted prior:
##     ~ exponential(rate = 0.28)
## ------
## See help('prior_summary.stanreg') for more details
```


---

# Inferencia Bayesiana con `tidymodels`

&lt;img src="08_regresion_lineal_files/figure-html/bayes3-1.png" height="500" style="display: block; margin: auto;" /&gt;

---

# Inferencia Bayesiana con `tidymodels`

### Diagnóstico de convergencia

--

1. **Rhat**: Factor Potencial de Reducción de Escala, hay convergencia si RHAT &lt; 1.1

--

2. **MCSE**: Error Estándar Monte Carlo

--

3. **N_eff**: Número efectivo de simulaciones equivalente a una muesta independiente

---

# Inferencia Bayesiana con `tidymodels`

### Diagnóstico de convergencia

<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ebfjiztsno .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ebfjiztsno .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ebfjiztsno .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ebfjiztsno .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ebfjiztsno .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ebfjiztsno .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ebfjiztsno .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ebfjiztsno .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ebfjiztsno .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ebfjiztsno .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ebfjiztsno .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ebfjiztsno .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ebfjiztsno .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ebfjiztsno .gt_from_md > :first-child {
  margin-top: 0;
}

#ebfjiztsno .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ebfjiztsno .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ebfjiztsno .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#ebfjiztsno .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ebfjiztsno .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#ebfjiztsno .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ebfjiztsno .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ebfjiztsno .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ebfjiztsno .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ebfjiztsno .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ebfjiztsno .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#ebfjiztsno .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ebfjiztsno .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#ebfjiztsno .gt_left {
  text-align: left;
}

#ebfjiztsno .gt_center {
  text-align: center;
}

#ebfjiztsno .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ebfjiztsno .gt_font_normal {
  font-weight: normal;
}

#ebfjiztsno .gt_font_bold {
  font-weight: bold;
}

#ebfjiztsno .gt_font_italic {
  font-style: italic;
}

#ebfjiztsno .gt_super {
  font-size: 65%;
}

#ebfjiztsno .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="ebfjiztsno" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="4" class="gt_heading gt_title gt_font_normal" style>Convergencia de la Simulación</th>
    </tr>
    <tr>
      <th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Parametro</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mcse</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Rhat</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">n_eff</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">(Intercept)</td>
      <td class="gt_row gt_right">0.027</td>
      <td class="gt_row gt_right">1.000</td>
      <td class="gt_row gt_right">17,871.000</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">Father</td>
      <td class="gt_row gt_right">0.000</td>
      <td class="gt_row gt_right">1.000</td>
      <td class="gt_row gt_right">17,846.000</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">sigma</td>
      <td class="gt_row gt_right">0.001</td>
      <td class="gt_row gt_right">1.000</td>
      <td class="gt_row gt_right">16,712.000</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">mean_PPD</td>
      <td class="gt_row gt_right">0.001</td>
      <td class="gt_row gt_right">1.000</td>
      <td class="gt_row gt_right">17,631.000</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">log-posterior</td>
      <td class="gt_row gt_right">0.014</td>
      <td class="gt_row gt_right">1.000</td>
      <td class="gt_row gt_right">8,400.000</td>
    </tr>
  </tbody>
  
  
</table></div>
---

# Inferencia Bayesiana con `tidymodels`

### Diagnóstico de convergencia

&lt;img src="08_regresion_lineal_files/figure-html/bayes7-1.png" width="425" style="display: block; margin: auto;" /&gt;


---

# Inferencia Bayesiana con `tidymodels`

### Predicción

<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#fajiksdhnm .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fajiksdhnm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fajiksdhnm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fajiksdhnm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fajiksdhnm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fajiksdhnm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fajiksdhnm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fajiksdhnm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fajiksdhnm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fajiksdhnm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fajiksdhnm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fajiksdhnm .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#fajiksdhnm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fajiksdhnm .gt_from_md > :first-child {
  margin-top: 0;
}

#fajiksdhnm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fajiksdhnm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fajiksdhnm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#fajiksdhnm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fajiksdhnm .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#fajiksdhnm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fajiksdhnm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fajiksdhnm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fajiksdhnm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fajiksdhnm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fajiksdhnm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#fajiksdhnm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fajiksdhnm .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#fajiksdhnm .gt_left {
  text-align: left;
}

#fajiksdhnm .gt_center {
  text-align: center;
}

#fajiksdhnm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fajiksdhnm .gt_font_normal {
  font-weight: normal;
}

#fajiksdhnm .gt_font_bold {
  font-weight: bold;
}

#fajiksdhnm .gt_font_italic {
  font-style: italic;
}

#fajiksdhnm .gt_super {
  font-size: 65%;
}

#fajiksdhnm .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="fajiksdhnm" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="5" class="gt_heading gt_title gt_font_normal" style>Simulacion Predictiva</th>
    </tr>
    <tr>
      <th colspan="5" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Father</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Mean</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Lower</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Upper</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">sigma</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_right">64.0</td>
      <td class="gt_row gt_right">64.63</td>
      <td class="gt_row gt_right">57.86</td>
      <td class="gt_row gt_right">71.49</td>
      <td class="gt_row gt_right">3.46</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">65.0</td>
      <td class="gt_row gt_right">65.00</td>
      <td class="gt_row gt_right">58.16</td>
      <td class="gt_row gt_right">71.86</td>
      <td class="gt_row gt_right">3.49</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">65.5</td>
      <td class="gt_row gt_right">65.24</td>
      <td class="gt_row gt_right">58.50</td>
      <td class="gt_row gt_right">72.07</td>
      <td class="gt_row gt_right">3.51</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">66.0</td>
      <td class="gt_row gt_right">65.42</td>
      <td class="gt_row gt_right">58.61</td>
      <td class="gt_row gt_right">72.23</td>
      <td class="gt_row gt_right">3.48</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">66.5</td>
      <td class="gt_row gt_right">65.61</td>
      <td class="gt_row gt_right">58.85</td>
      <td class="gt_row gt_right">72.41</td>
      <td class="gt_row gt_right">3.47</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">67.0</td>
      <td class="gt_row gt_right">65.84</td>
      <td class="gt_row gt_right">59.02</td>
      <td class="gt_row gt_right">72.65</td>
      <td class="gt_row gt_right">3.47</td>
    </tr>
  </tbody>
  
  
</table></div>
---

# Inferencia Bayesiana con `tidymodels`

### Ajuste

&lt;img src="08_regresion_lineal_files/figure-html/bayes_predict-1.png" height="400" style="display: block; margin: auto;" /&gt;

---

# ¿Qué nos faltó?

--

1. Pruebas del supuesto de normalidad (Análisis de Residuales vs. Factores de Bayes)

--

2. Regresión lineal múltiple y selección de modelos
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": true,
"self_contained": true,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
